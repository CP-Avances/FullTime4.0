<div>
    <div class="container" style="padding-top: 15px;">
        <mat-card class="example-card mat-elevation-z8">
            <div id="titulo">
                <button class="btn btn-outline-light btn-sm" style="float: left; margin-left: 10px;"
                    (click)="VerUsuarioAsignado()">
                    Atras
                </button>
                <span>{{name_sucursal}}</span>
            </div>
            <mat-card-content>
                <div class="mat-elevation-z8" style="background: white;"
                    style="padding-top: 10px; padding-bottom: 5px;">
                    <div class="row">
                        <!--  **************************** LISTA DE USUARIOS QUE PERTENECEN A UNA SUCURSAL *********************************  -->
                        <div class="col-md" *ngIf="ver_principal" style="padding-bottom: 10px;">
                            <div id="resultados">Usuarios que pertenecen a {{name_sucursal}}</div>
                            <div class="table-responsive">
                                <table class="table table-hover table-sm">
                                    <thead class="thead-light">
                                        <tr style="text-align: center;">
                                            <th scope="col">Rol</th>
                                            <th scope="col">Nombre</th>
                                            <th scope="col">Departamento</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                      <tr>
                                        <td>
                                          <mat-form-field class="input-tables">
                                            <input matInput placeholder="Buscar" [(ngModel)]="filtroRol" type="text" [formControl]="rol">
                                          </mat-form-field>
                                        </td>
                                        <td>
                                          <mat-form-field class="input-tables">
                                            <input matInput placeholder="Buscar" [(ngModel)]="filtroNombre" type="text" [formControl]="nombre">
                                          </mat-form-field>
                                        </td>
                                        <td>
                                          <mat-form-field class="input-tables">
                                            <input matInput placeholder="Buscar" [(ngModel)]="filtroDepartamento" type="text" [formControl]="departamento">
                                          </mat-form-field>
                                        </td>
                                      </tr>
                                        <tr *ngFor="let p of principales | sucRolEmpleado: filtroRol | sucNomEmpleado: filtroNombre | sucDepEmpleado: filtroDepartamento">
                                          <td><mat-checkbox [(ngModel)]="p.seleccionado" (change)="SeleccionarEmpleado(p)"></mat-checkbox> </td>
                                          <td>{{p.rol}}</td>
                                          <td>{{p.apellido}} {{p.nombre}} </td>
                                          <td>{{p.departamento}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <mat-paginator id="pagina" [length]="principales.length" [pageSize]="tamanio_pagina_p"
                                [pageSizeOptions]="pageSizeOptions_p" (page)="ManejarPaginaPrincipal($event)"
                                showFirstLastButtons>
                            </mat-paginator>
                        </div>
                        <!--  **************************** LISTA DE USUARIOS ASIGNADOS A UNA SUCURSAL *********************************  -->
                        <div class="col-md" *ngIf="ver_asignados">
                            <div id="resultados">Usuarios asignados a {{name_sucursal}}</div>
                            <div class="table-responsive">
                                <table class="table table-hover table-sm ">
                                    <thead class="thead-light">
                                        <tr style="text-align: center;">
                                            <th>
                                                <mat-icon *ngIf="activar_seleccion" class="flex-shrink-1 bd-highlight"
                                                    matSuffix matTooltipPosition="right"
                                                    matTooltip="Dar clic para activar selección múltiple."
                                                    id="SelectCheck" (click)="HabilitarSeleccion()">
                                                    library_add_check
                                                </mat-icon>
                                                <mat-checkbox *ngIf="plan_multiple"
                                                    (change)="$event ? masterToggleDep() : null"
                                                    [checked]="selectionAsignados.hasValue() && isAllSelectedDep()"
                                                    [indeterminate]="selectionAsignados.hasValue() && !isAllSelectedDep()"
                                                    [aria-label]="checkboxLabelDep()" (click)="InhabilitarSeleccion()">
                                                </mat-checkbox>
                                            </th>
                                            <th scope="col">Usuario</th>
                                            <th scope="col">Rol</th>
                                            <th scope="col">Jefe/Coordinador</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let a of asignados">
                                            <td>
                                                <mat-checkbox *ngIf="plan_multiple_" (click)="$event.stopPropagation()"
                                                    (change)="$event ? selectionAsignados.toggle(a) : null"
                                                    [checked]="selectionAsignados.isSelected(a)"
                                                    [aria-label]="checkboxLabelDep(a)">
                                                </mat-checkbox>
                                            </td>
                                            <td>{{a.apellido}} {{a.nombre}} </td>
                                            <td>{{a.rol}}</td>
                                            <td>
                                                <mat-checkbox *ngIf="a.jefe === true" matSuffix
                                                    matTooltipPosition="right" disabled [checked]="a.jefe">
                                                </mat-checkbox>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="container d-flex flex-wrap justify-content-center">
                                <button *ngIf="this.selectionAsignados.selected.length != 0" id="btn-raised"
                                    class="btn btn-sm" (click)="ConfirmarDeleteProceso()">
                                    Eliminar
                                </button>
                            </div>
                            <mat-paginator id="pagina" [length]="asignados.length" [pageSize]="tamanio_pagina_a"
                                [pageSizeOptions]="pageSizeOptions_a" (page)="ManejarPaginaAsignados($event)"
                                showFirstLastButtons>
                            </mat-paginator>
                        </div>
                    </div>

                    <hr>

                    <div style="padding-top: 10px;">
                        <div id="resultados">Usuarios asignados a {{name_sucursal}}</div>
                        <div class="nota" id="espacio" style="text-align: justify; margin-left: 15px;">
                            <span>
                                NOTA: Asignación de usuarios a la administración de los datos del establecimiento
                                {{name_sucursal}}.
                            </span>
                        </div>
                        <div class="container d-flex flex-wrap justify-content-center">
                            <mat-form-field>
                                <input type="text" placeholder="Establecimiento" aria-label="Number" matInput
                                    [formControl]="sucursalForm" [matAutocomplete]="auto" required>
                                <mat-autocomplete #auto="matAutocomplete">
                                    <mat-option *ngFor="let option of filteredOptions | async" [value]="option.nombre"
                                        (click)="ObtenerUsuarios()">
                                        {{option.nombre}}
                                    </mat-option>
                                </mat-autocomplete>
                                <mat-icon matSuffix matTooltipPosition="right"
                                    matTooltip="Seleccionar un establecimiento.">
                                    help_outline
                                </mat-icon>
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <div class="col-md" style="padding-bottom: 10px;">
                                <div class="container" style="padding-top: 20px;" *ngIf="ver_administradores">
                                    <div id="resultados">
                                        <span>
                                            LISTA DE USUARIOS
                                        </span>
                                    </div>
                                </div>
                                <div class="d-flex flex-wrap justify-content-start">
                                    <div class="modal-body" style="margin-left: 60px; padding-top: 15px;">
                                        <div class="container-fluid">
                                            <input class="form-check-input" type="checkbox" id="seleccionar"
                                                [(ngModel)]="isChecked" (change)="SeleccionarTodas(isChecked)"
                                                [ngModelOptions]="{standalone: true}" *ngIf="ver_seleccion">
                                            <label *ngIf="ver_seleccion" class="form-check-label" for="inlineCheckbox1"
                                                style="margin-left: 10px; font-size: 12px; color: blue; font-weight: bold;">
                                                Todas
                                            </label>
                                            <div class="row" style="text-align: center; padding-top: 10px;">
                                                <div class="col-md-6 col-lg-6 col-6"
                                                    style="text-align:left; padding-bottom: 10px;"
                                                    *ngFor="let n of administradores; index as i">
                                                    <input class="form-check-input" type="checkbox"
                                                        name="adminSeleccionados" id="adminSeleccionados{{i}}"
                                                        (change)="SeleccionarIndividual($event, n)">
                                                    <label style="margin-left: 10px; font-size: 11px;"
                                                        class="form-check-label" for="inlineCheckbox1">
                                                        {{n.apellido}} {{n.nombre}}
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md">
                                <div class="container" style="padding-top: 20px;" *ngIf="ver_administradores">
                                    <div id="resultados">
                                        <span>
                                            LISTA DE USUARIOS SELECCIONADOS
                                        </span>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-hover table-sm" id="detalle">
                                            <thead class="thead-light">
                                                <tr style="text-align: center;">
                                                    <th scope="col" colspan="2">Usuario</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let a of adminSeleccionados">
                                                    <td>{{a.apellido}} {{a.nombre}}
                                                        <span *ngIf="a.jefe === true">(Jefe)</span>
                                                    </td>
                                                    <td>
                                                        <i matSuffix matTooltipPosition="right"
                                                            matTooltip="Retirar de la lista"
                                                            class="fa fa-times-circle-o" id="t-eliminar"
                                                            (click)="RetirarLista(a.id)">
                                                        </i>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="container d-flex flex-wrap justify-content-center">
                                        <button *ngIf="adminSeleccionados.length != 0" id="btn-raised"
                                            class="btn btn-sm" (click)="VerificarDatos()">
                                            Verificar
                                        </button>
                                        <button *ngIf="ver_guardar" id="btn-raised" class="btn btn-sm"
                                            (click)="IngresarUsuarioSucursal()">
                                            Guardar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
</div>
