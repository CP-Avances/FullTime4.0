<ng-template mat-tab-label>
    <mat-icon class="example-tab-icon" id="icono_pestaña">description</mat-icon>
    <h6 id="items">Solicitudes de Vacaciones</h6>
</ng-template>

<!--  *********************  PANTALLA DE SOLICITUDES DE VACACIONES  *************************  -->
<div class="container" style="padding-bottom: 25px;" *ngIf="ver_periodo">
    <mat-card class="mat-elevation-z8">

        <div id="titulo" class="row w-100 m-auto">
            <div class="col-9 col-md-2 mb-2 mb-md-0 order-2 order-md-2">
            </div>
            <div class="col-12 col-md-7 mb-2 mb-md-0 order-1 order-md-2 Tabla_titulo">
                <span>
                    SOLICITUDES VACACIONES
                </span>
            </div>
            <div class="col-3 col-md-3 mb-2 mb-md-0 order-3 order-md-2">
                <button type="submit" class="btn btn-outline-light btn-sm" style="float: right;"
                    (click)="AbrirVentanaVacaciones()" *ngIf="getCrearDatos()">{{btnTitulo}}
                </button>
            </div>
        </div>

        <mat-card-content>
            <div *ngFor="let v of vacaciones" style="padding-top: 10px;">
                <div class="container">
                    <div class="row">
                        <div class="espacio d-flex w-100">
                            <div class="ms-auto text-end">
                                <span class="badge" [ngClass]="{
                                            'text-bg-secondary': v.estado === 1,
                                            'text-bg-warning':   v.estado === 2,
                                            'text-bg-success':   v.estado === 3,
                                            'text-bg-danger':    v.estado === 4
                                        }">
                                    {{
                                    v.estado === 1 ? 'PENDIENTE' :
                                    v.estado === 2 ? 'PREAUTORIZADO' :
                                    v.estado === 3 ? 'AUTORIZADO' :
                                    v.estado === 4 ? 'DENEGADO' : '—'
                                    }}
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md">
                            <div class="espacio d-flex justify-content-start">
                                <label id="datosF">Inicio de vacaciones:</label>
                                <label>{{ v.fecha_inicio_ || '—' }}</label>
                            </div>
                        </div>
                        <div class="col-md">
                            <div class="espacio d-flex justify-content-start">
                                <label id="datosF">Fin de vacaciones:</label>
                                <label>{{ v.fecha_final_ || '—' }}</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md">
                            <div class="espacio d-flex justify-content-start">
                                <label id="datosF">Cantidad solicitada:</label>
                                <label>
                                    <ng-container *ngIf="esPorDias(v); else porHoras">
                                        {{ formatearDias(v.numero_dias_totales) }}
                                    </ng-container>
                                    <ng-template #porHoras>
                                        {{ formatearHorasDesdeMin(v.minutos_totales) }}
                                    </ng-template>
                                </label>
                            </div>
                        </div>
                        <div class="col-md">
                            <div class="espacio d-flex justify-content-start">
                                <label id="datosF">Incluye feriados:</label>
                                <label>{{ v.incluir_feriados ? 'Sí' : 'No' }}</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md">
                            <div class="espacio d-flex justify-content-start">
                                <label id="datosF">Fecha de registro:</label>
                                <label>{{ v.fecha_registro_ || '—' }}</label>
                            </div>
                        </div>
                        <div class="col-md">
                            <div class="espacio d-flex justify-content-start">
                                <label id="datosF">Fecha de actualización:</label>
                                <label>{{ v.fecha_actualizacion_ || '02/09/2025' }}</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md">
                            @for (v of vacaciones; track $index) {
                            <div class="espacio d-flex justify-content-start">
                                <label id="datosF">Documento:</label>
                                <a matSuffix matTooltipPosition="right" mattooltip="Dar click para descargar documento."
                                    href="{{hipervinculo}}/vacaciones/documentos/{{ v.documento }}" target="blank">
                                    <label>{{v.documento}}</label>
                                </a>
                            </div>
                            }
                        </div>
                    </div>

                    <div class="col-md">
                        <div style="text-align: right; margin-right: 10px;">
                            <i class="fas fa-edit" id="edit" matSuffix matTooltipPosition="right"
                                matTooltip="Modificar los datos generales de este registro.">
                                <p><app-solicitudes-vacaciones /></p>
                            </i>
                            <i class="fas fa-times-circle" id="cerrar" matSuffix matTooltipPosition="right"
                                matTooltip="Eliminar solicitudes de vacaciones.">
                                <p>Eliminar</p>
                            </i>
                        </div>
                    </div>
                    <mat-divider></mat-divider>
                    <div class="text-center mt-4 mb-2">
                        <strong class="fs-8 text-secondary">
                            {{ permiteHoras
                            ? 'Horas seleccionadas por día de la semana'
                            : 'Número de días (por día de la semana) en el periodo seleccionado' }}
                        </strong>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-md-12">
                            <div class="table-responsive">
                                <table class="table table-sm text-center align-middle" style="width: 100%;">
                                    <thead class="table-secondary">
                                        <tr>
                                            <th class="col-total-compacta">Lunes</th>
                                            <th class="col-total-compacta">Martes</th>
                                            <th class="col-total-compacta">Miércoles</th>
                                            <th class="col-total-compacta">Jueves</th>
                                            <th class="col-total-compacta">Viernes</th>
                                            <th class="col-total-compacta">Sábado</th>
                                            <th class="col-total-compacta">Domingo</th>
                                            <th class="col-total-compacta">
                                                {{ permiteHoras ? 'Horas totales' : 'Días totales' }}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="col-total-compacta"
                                                [ngClass]="{ 'dia-seleccionado': permiteHoras && diaSemanaSeleccionado === 'L' }">
                                                {{ v.numero_dias_lunes}}
                                            </td>
                                            <td class="col-total-compacta"
                                                [ngClass]="{ 'dia-seleccionado': permiteHoras && diaSemanaSeleccionado === 'M' }">
                                                {{ v.numero_dias_martes }}
                                            </td>
                                            <td class="col-total-compacta"
                                                [ngClass]="{ 'dia-seleccionado': permiteHoras && diaSemanaSeleccionado === 'X' }">
                                                {{ v.numero_dias_miercoles }}
                                            </td>
                                            <td class="col-total-compacta"
                                                [ngClass]="{ 'dia-seleccionado': permiteHoras && diaSemanaSeleccionado === 'J' }">
                                                {{ v.numero_dias_jueves }}
                                            </td>
                                            <td class="col-total-compacta"
                                                [ngClass]="{ 'dia-seleccionado': permiteHoras && diaSemanaSeleccionado === 'V' }">
                                                {{v.numero_dias_viernes }}
                                            </td>
                                            <td class="col-total-compacta"
                                                [ngClass]="{ 'dia-seleccionado': permiteHoras && diaSemanaSeleccionado === 'S' }">
                                                {{ v.numero_dias_sabado }}
                                            </td>
                                            <td class="col-total-compacta"
                                                [ngClass]="{ 'dia-seleccionado': permiteHoras && diaSemanaSeleccionado === 'D' }">
                                                {{ v.numero_dias_domingo }}
                                            </td>
                                            <td class="col-total-compacta text-bold">
                                                {{ v.numero_dias_totales }}
                                            </td>
                                        </tr>
                                    </tbody>

                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </mat-card-content>
    </mat-card>
</div>
<!-- *** REGISTRO DE VACACIONES INDIVIDUALES *** -->
@if (activar_vacacion_individual) {
<div style="padding-top: 20px;">
    <app-registrar-solicitudes-vacaciones [data]="empleadoUno" />
</div>
}
<div style="padding-top: 20px;" id="edit" style="cursor: pointer"
    [routerLink]="['/solicitudes-vacaciones/editar']">
    <p>Editar</p>
</div>
<router-outlet></router-outlet>